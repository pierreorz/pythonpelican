<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
  <head>
    <title>Posts von pierreorz - dengdezhao</title>
    <link href="http://fonts.googleapis.com/css?family=Arimo:400,700|Inika" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="http://pelican.dengdezhao.cn/theme/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="http://pelican.dengdezhao.cn/theme/pastie.css" />
    <link href="http://pelican.dengdezhao.cn/" type="application/atom+xml" rel="alternate" title="dengdezhao Atom Feed" />


  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="span8">
<div id="content">
<h2>Posts von pierreorz</h2>

<ul class="unstyled">
        <li>
            <div>
                <div class="header">
                    <h2>"ADF类似心跳程序实现"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Wed 24 April 2013</span> - <span class="tags"><a href="/tag/poll/">poll</a></span></small></p>
                <div class="entry-content">
                    <p>使用ADF框架开发WEB应用时，其中令人苦恼的一个需求就是：在两个页面同时展示一个数据源时，如果其中一个页面对数据源作了变更操作，另外一个页面没办法自动获得变更后的数据，需要手工刷新页面才能得到变更后的新数据源。   </p>
<p>其实ADF自带的<code>&lt;af:poll/&gt;</code>组件即可实现此需求。</p>
<p>例子：</p>
<ul>
<li>创建一个可更新的af:table 基于HR的Department表</li>
</ul>
<p>可以更改表数据并提交，用多浏览器窗口打开该页面来模拟多用户操作。</p>
<p>将<code>&lt;af:poll/&gt;</code>控件拖入到页面中，控件属性设置如下：    </p>
<p>设置间隔为1分钟，并绑定PollListener</p>
<ul>
<li>给该页面绑定ManagedBean，并添加PollListener，方法内容如下：    </li>
</ul>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
    public void heartBeat(PollEvent pollEvent) {
        System.out.println("start poll...");      <br />
        DCIteratorBinding it = ADFUtils.findIterator("Departments1Iterator");
        ViewObject vo = it.getViewObject();
        vo.executeQuery …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/adflei-si-xin-tiao-cheng-xu-shi-xian.html" rel="bookmark" title="Permalink to "ADF类似心跳程序实现"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"ADF学习总结(一)"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Fri 19 April 2013</span> - <span class="tags"><a href="/tag/ViewCriteria/">ViewCriteria</a></span></small></p>
                <div class="entry-content">
                    <h4>改变VO查询条件</h4>
<ul>
<li>使用WhereClause改变查询条件</li>
<li>使用Criteria改变查询条件</li>
<li>使用Bind Variables改变查询条件</li>
</ul>
<h4>使用WhereClause改变查询条件</h4>
<ul>
<li><strong>setWhereClause</strong>    </li>
</ul>
<p _="%" endcodeblock="endcodeblock">通过VO对象的setWhereClause方法改变查询条件
{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");  <br />
ViewObject vo = dc.getViewObject();     <br />
vo.setWhereClause(" 1=1 ");  <br />
vo.executeQuery();   <br /></p>
<ul>
<li><strong>addWhereClause</strong></li>
</ul>
<p>addWhereClause是在原有whereClause基础上添加新的查询条件；  <br />
跟setWhereClause替换原有whereClaue不同；</p>
<h4>使用ViewCriteria改变查询条件</h4>
<ul>
<li><strong>使用定义好的ViewCriteria</strong>    </li>
</ul>
<p>事先在创建VO的时候，定义好几种Criteria：DepartmentsViewCriteria    </p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");      <br />
ViewObject vo = dc.getViewObject();         <br />
ViewCriteriaManager vcm=vo.getViewCriteriaManager …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/adfxue-xi-zong-jie-yi.html" rel="bookmark" title="Permalink to "ADF学习总结(一)"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"OAF中创建LOV"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Thu 18 April 2013</span> - <span class="tags"><a href="/tag/oaf/">oaf</a></span></small></p>
                <div class="entry-content">
                    <p>环境：Oracle9i Jdeveloper+R11i</p>
<h4>首先创建AM</h4>
<p>创建一个LovAM，默认配置即可。</p>
<h4>创建VO</h4>
<p _="%" endcodeblock="endcodeblock">创建LovVO，不需要基于EO，输入查询SQL如下：
{% codeblock lang:sql %}
select distinct INVENTORY_ITEM_ID,concatenated_segments 
from MTL_SYSTEM_ITEMS_KFV where organization_id=85</p>
<p>将创建好的VO添加到AM的data module中</p>
<h4>创建RN</h4>
<p>右键工程，创建一个RN，Scope设置为public.    </p>
<p>选中创建好的LovRN.xml，在structure Window窗口中选中LovRN右建New Region Using Wizard.找到之前创建的LovVO.    </p>
<p>修改字段属性如下：   <br />
Search Allowed : true   <br />
Selective Search Criteria : true    </p>
<h4>创建PG页面引用LOV</h4>
<p>创建一个PG页面LovPG.xml，AM Definition设置为之前创建的LovAM路径 …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/oafzhong-chuang-jian-lov.html" rel="bookmark" title="Permalink to "OAF中创建LOV"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"配置OAF开发环境"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Wed 17 April 2013</span> - <span class="tags"><a href="/tag/oaf/">oaf</a></span></small></p>
                <div class="entry-content">
                    <h4>查看EBS系统OA版本信息</h4>
<p>方法一：使用OPERATIONS用户登陆EBS系统，选择“Diagnostics”后，在页下脚选择“About this Page”后选择“Technology Components”标签可查看相应版本信息。</p>
<p _="%" endcodeblock="endcodeblock">方法二：访问URI：<em>R12不可用</em>  <br />
{% codeblock lang:java %}
http://<HOST>:<PORT>/OA_HTML/OAInfo.jsp  <br /></p>
<h4>查看OAF版本下载相应JDEV开发工具</h4>
<p>metalink document id: 787209.1 &amp; 416708.1</p>
<p>例如：p4141787_11i_GENERIC.zip</p>
<p>解压缩后把“/jdevhome/jdev”路径加到系统变量中，变量名：      JDEV_USER_HOME=F:\p4141787_11i_GENERIC\jdevhome\jdev</p>
<h4>配置DBC文件</h4>
<p>确认当前EBS系统使用的dbc文件.</p>
<p _="%" endcodeblock="endcodeblock">连接EBS数据库，执行以下SQL查询：
{% codeblock …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/pei-zhi-oafkai-fa-huan-jing.html" rel="bookmark" title="Permalink to "配置OAF开发环境"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"getRowAtRangeIndex(int)方法的局限性"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Tue 16 April 2013</span> - <span class="tags"><a href="/tag/excel/">excel</a></span></small></p>
                <div class="entry-content">
                    <p _="%" endcodeblock="endcodeblock">导出VO中的数据到EXCEL中时，循环VO中的Row，写入HSSFRow，是通过getRowAtRangeIndex(int)方法循环取Row，代码如下：  <br />
{% codeblock lang:java %}
 ViewObject vo8=am.findViewObject("ChReport1VO1");
 if(vo8!=null)
 {
      int rowcount8=vo8.getRowCount();
      for(int i=0;i&lt;rowcount8;i++)
      {
           Row vo_row8=vo8.getRowAtRangeIndex(i);
           //...TODO
      }
 }</p>
<p>这样如果VO里有300条数据，但是pageRange设置为100，这里其实只能取到第一页的100条数据，想要导出所有300条数据则需要一页一页导出，很麻烦。于是考虑不用getRowAtRangeIndex方法取ROW数据,改用RowSetIterator。</p>
<p>{% codeblock lang:java %}
ViewObject vo8=am.findViewObject("ChReport1VO1 …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/getrowatrangeindexintfang-fa-de-ju-xian-xing.html" rel="bookmark" title="Permalink to "getRowAtRangeIndex(int)方法的局限性"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"OAF上传大批量EXCEL文件"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Tue 09 April 2013</span> - <span class="tags"><a href="/tag/oaf/">oaf</a></span></small></p>
                <div class="entry-content">
                    <p>客户有个需求：大量数据通过EXCEL导入系统表，并能提供效验及去重功能。</p>
<h4>设计思路</h4>
<ul>
<li>采用POI解析EXCEL文件；</li>
<li>bulk insert 插入数据到临时表</li>
<li>临时表结合正式表去除重复</li>
</ul>
<h4>POI解析EXCEL</h4>
<p>在CO的<code>processFormRequest</code>方法中添加如下:  <br />
{% codeblock lang:java %}
  public void processFormRequest(OAPageContext pageContext, OAWebBean webBean)
  {
    super.processFormRequest(pageContext, webBean);
    OAApplicationModule am = pageContext.getApplicationModule(webBean);</p>
<div class="highlight"><pre><span></span>if (pageContext.getParameter(&quot;uploadBtn&quot;) != null)
{
  DataObject fileUploadData = (DataObject)pageContext.getNamedDataObject(&quot;uploadFile&quot;);
  String fileName = null;
  try {
    fileName = (String)fileUploadData …</pre></div>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/oafshang-chuan-da-pi-liang-excelwen-jian.html" rel="bookmark" title="Permalink to "OAF上传大批量EXCEL文件"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"Jdeveloper运行速度优化"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Thu 04 April 2013</span> - <span class="tags"><a href="/tag/jdeveloper/">jdeveloper</a>, <a href="/tag/AddVMOption/">AddVMOption</a></span></small></p>
                <div class="entry-content">
                    <h4><em>本文适合木有高配机却不得不在JDEV下开发的屌丝程序员</em></h4>
<h4>先来了解下Jdev的两个配置文件</h4>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
E:\Oracle\Middleware11.1.2.3.0\jdeveloper\ide\bin\ide.conf  <br />
E:\Oracle\Middleware11.1.2.3.0\jdeveloper\jdev\bin\jdev.conf</p>
<p _="%" endcodeblock="endcodeblock">几个关键参数：
{% codeblock lang:java %}
AddVMOption  -Xmx        //堆大小的最大值，在机器物理内存允许的基础上该值越大越好
AddVMOption  -Xms        //堆大小的初始值（默认给个128差不多）
AddVMOption  -XX:MaxPermSize //PermGen大小，太小会报OutOfMemoryError错误<br /></p>
<p _="%" endcodeblock="endcodeblock">这几个参数设置得不合适的话JDEV会无法启动并报以下错误：
{% codeblock lang:java …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/jdeveloperyun-xing-su-du-you-hua.html" rel="bookmark" title="Permalink to "Jdeveloper运行速度优化"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"JavaMail发送邮件中文乱码"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Wed 20 March 2013</span> - <span class="tags"><a href="/tag/javamail/">javamail</a></span></small></p>
                <div class="entry-content">
                    <p>使用JavaMail发送邮件时，邮件主题以及发件人中有中文字符时出现乱码</p>
<p>邮件正文正常。</p>
<p>尝试对中文字符串进行转码：</p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
    public String encode(String str) {
        sun.misc.BASE64Encoder enc = new sun.misc.BASE64Encoder();
        try {
            return "=?UTF-8?B?" + enc.encode(str.getBytes("UTF-8")) + "?=";
        } catch (UnsupportedEncodingException e) {
            return "UnsupportedEncodingException";
        }
    }</p>
<p _="%" endcodeblock="endcodeblock">测试发送之后返回<code>邮件主题</code>内容仍然是乱码
{% codeblock lang:java %}
=?UTF-8?B?WzIwMTMtMDMtMTld5pyq5qOA5pyq5Lqk5pWw5o2uLOaAu+ijhei9pumXtOaVhemanOi9puWBnOi9</p>
<p>通过返回字符串<code>=?UTF-8?B?</code>得知已经转码成功，但为啥邮件主题仍然乱码？百思不得其解 …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/javamailfa-song-you-jian-zhong-wen-luan-ma.html" rel="bookmark" title="Permalink to "JavaMail发送邮件中文乱码"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"Jive Forums admin console 管理员账户密码重置"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Wed 20 March 2013</span> - <span class="tags"><a href="/tag/Jive/">Jive</a></span></small></p>
                <div class="entry-content">
                    <h4><i class="icon-file"></i>   需求：</h4>
<p>webcenter集成AD 之后发现Discussion控件用不了，使用weblogic账号也无法进入Jive forums的控制台，但是weblogic控制台可以登录。于是想重置Jive Forums的管理账号密码。</p>
<h4><i class="icon-folder-open"></i> 分析：</h4>
<p>修改jiveuser表将管理员账户密码更新即可。</p>
<h4><i class="icon-pencil"></i> 技术实现：</h4>
<ul>
<li>连接到FM_DISCUSSIONS schema，查询jiveuser，发现passwordhash字段值变为了"-"字符，可能是集成AD之后这边的数据被覆盖了，按字段名推测密码应该是hash加密后的密文，于是将weblogic用户的密码通过MD5加密生成密文更新该字段，重启webcenter之后，问题解决。</li>
</ul>
<p _="%" endcodeblock="endcodeblock">附：
{% codeblock lang:java %}
//password: Welcome1 
update jiveuser set passwordhash='b56e0b4ea4962283bee762525c2d490f' where username='weblogic'</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/jive-forums-admin-console-guan-li-yuan-zhang-hu-mi-ma-zhong-zhi.html" rel="bookmark" title="Permalink to "Jive Forums admin console 管理员账户密码重置"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
        <li>
            <div>
                <div class="header">
                    <h2>"OAF单选删除行功能"</h2>
                </div>
                <p class="meta"><small><span><a href="http://pelican.dengdezhao.cn/author/pierreorz/">pierreorz</a> - </span><span>Wed 20 March 2013</span> - <span class="tags"><a href="/tag/oaf/">oaf</a></span></small></p>
                <div class="entry-content">
                    <hr />
<p>平台：Jdeveloper 9i    </p>
<hr />
<p><strong>一般实现步骤：</strong></p>
<ol>
<li>在VO中添加新transient属性selector，updatable设置为always。    </li>
<li>在PG中给table添加singleSelection方法，并绑定view Instance为VO的instance，View Attribute为刚刚新建的transient属性seletor。        </li>
<li>这样当用户勾选checkbox时，会给transient属性变量赋值为Y，因此，在删除逻辑中循环判断VO中的transient属性，当其为Y时执行remove该行即可实现选择删除功能。  <br />
<strong>相关代码如下：</strong></li>
</ol>
<p><strong>CO中processFormRequest里添加代码如下：</strong></p>
<p>{% codeblock lang:java %}
    //当单击deleteBtn按钮时执行AM中的deleteAutoSequenceVO方法  <br />
    if (pageContext.getParameter("deleteBtn")!=null)
    {
      am.invokeMethod("deleteAutoSequenceVO");</p>
<div class="highlight"><pre><span></span>}
</pre></div>


<p>{% endcodeblock %}</p>
<p><strong>AM中代码如下：</strong></p>
<p>{% codeblock lang:java %}
    public void deleteAutoSequenceVO() {
        OAViewObject vo = this.getChAutoSequenceVO1();
        RowSetIterator iter = vo.createRowSetIterator("delete");
        if (vo != null …</p>
                </div><!-- /.entry-content -->
                <div class="row">
                    <div class="span4">
                    </div>
                    <div class="span1 offset3">
                        <a class="btn btn-small" href="http://pelican.dengdezhao.cn/oafdan-xuan-shan-chu-xing-gong-neng.html" rel="bookmark" title="Permalink to "OAF单选删除行功能"">Mehr</a>
                    </div>
                </div>
            </div>
        </li>

        <li><hr /></li>
</ul><!-- /#posts-list -->

<div class="pagination pagination-centered">
    <ul>
        <li><a href="http://pelican.dengdezhao.cn">1</a></li>
        <li><a href="http://pelican.dengdezhao.cnauthor/pierreorz2/">2</a></li>
        <li class="active"><a href="#">3</a></li>
        <li><a href="http://pelican.dengdezhao.cnauthor/pierreorz4/">4</a></li>
        <li class="disabled"><a href="#">...</a></li>
        <li><a href="http://pelican.dengdezhao.cnauthor/pierreorz7/">7</a></li>
    </ul>
</div>
</div><!-- /#content -->
        </div>
        <div class="span3 offset1">
          <div class="well">
            <ul class="nav nav-list">
              <li class="nav-header">Blog</li>
              <li ><a href="http://pelican.dengdezhao.cn">Index</a></li>
              <li ><a href="http://pelican.dengdezhao.cn/tags/">Tags</a></li>
              <li ><a href="http://pelican.dengdezhao.cn/archives/">Archiv</a></li>
            </ul>
          </div><!-- /#menu -->
        </div>
      </div>

      <hr />

      <div class="row">
        <div class="span12">
          <div id="about">
            <p>Proudly powered by <a href="http://twitter.github.com/bootstrap/">bootstrap</a>, <a href="http://docs.notmyidea.org/alexis/pelican/">pelican</a>, <a href="http://python.org">python</a> and <a href="http://www.julo.ch/about/">Alex</a>!</p>
          </div><!-- /#about -->
        </div><!-- /#contentinfo -->
      </div>
    </div>


  </body>
</html>