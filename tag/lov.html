<!DOCTYPE html>
<html lang="en">
<head>
        <title>dengdezhao - LOV</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://pelican.dengdezhao.cn/theme/css/main.css" type="text/css" />
        <link href="http://pelican.dengdezhao.cn/None" type="application/atom+xml" rel="alternate" title="dengdezhao ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie.css"/>
                <script src="http://pelican.dengdezhao.cn/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie6.css"/><![endif]-->

</head>

<body>
        
        

            <header>
                <h1><a href="http://pelican.dengdezhao.cn" id="site-title">dengdezhao </a> : <a href="http://pelican.dengdezhao.cn/dong-tai-gai-bian-lovde-zhi-ji.html" id="page-title">"动态改变LOV的值集"</a></h1>
<time datetime="2014-09-17T00:00:00+08:00">2014-09-17(Wednesday) 00:00</time>            </header>

            <article>
                <h4><i class="icon-file"></i>   需求：</h4>
<p>LOV的值集需要根据传入的用户角色类型(A,B,C)动态改变，A时查询所有，B时过滤字段1，C时过滤字段2.</p>
<p><strong>基础VO的SQL如下:</strong>
{% codeblock lang:sql %}
 SELECT DISTINCT U.USER_ID, U.USER_NAME, F.FULL_NAME AS DESCRIPTION
  FROM FND_USER U, PO_HEADERS_ALL P, PO_VENDORS V, PER_PEOPLE_F F
 WHERE U.EMPLOYEE_ID = P.AGENT_ID
   AND P.VENDOR_ID = V.VENDOR_ID
   AND F.PERSON_ID(+) = U.EMPLOYEE_ID
   AND P.APPROVED_FLAG = 'Y'
   AND ((P.VENDOR_ID = :VARVENDORID AND :VARUSERTYPE = 'B') OR
       (:VARUSERTYPE = 'A') OR
       (:VARUSERTYPE = 'C' AND U.USER_ID = :VARUSERID))
{% endcodeblock %}
创建VARUSERTYPE VARUSERID VARVENDORID 三个绑定变量。</p>
<h4><i class="icon-folder-open"></i> 创建LOV VO</h4>
<p><strong>LVO的SQL如下:</strong>
{% codeblock lang:sql %}
 SELECT NULL         AS USER_ID,
       NULL         AS USER_NAME,
       NULL         AS DESCRIPTION,
       :VARTYPE     AS USERTYPE,<br />
       :VARVENDORID AS VENDORID,
       :VARUSERID   AS CURRENTUSERID
  FROM DUAL
{% endcodeblock %}
技巧在这里，LVO同样创建三个绑定变量，并把绑定变量作为VO的attribute暴露出来，然后通过view Accessors传递给基础VO</p>
<h4><i class="icon-pencil"></i> 设置View Accessors</h4>
<ul>
<li>
<p>创建LOV    </p>
</li>
<li>
<p>设置View Accessors    </p>
</li>
</ul>
<p>这样就可以实现动态切换LOV的基础数据源了。</p>            </article>

        <footer>
            <nav>
                <ul>
                    <li>:: <a href="http://pelican.dengdezhao.cn/categories.html">Categories</a></li>
                    <li>:: <a href="http://pelican.dengdezhao.cn/tags.html">Tags</a></li>
                </ul>
            </nav>
                <p id="theme-credit"><a href="http://mathieu.agopian.info/mnmlist/theme.html">Thème mnmlist</a></p>
        </footer>

</body>
</html>