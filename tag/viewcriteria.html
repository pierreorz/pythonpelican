<!DOCTYPE html>
<html lang="en">
<head>
        <title>dengdezhao - ViewCriteria</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://pelican.dengdezhao.cn/theme/css/main.css" type="text/css" />
        <link href="http://pelican.dengdezhao.cn/None" type="application/atom+xml" rel="alternate" title="dengdezhao ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie.css"/>
                <script src="http://pelican.dengdezhao.cn/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie6.css"/><![endif]-->

</head>

<body>
        
        

            <header>
                <h1><a href="http://pelican.dengdezhao.cn" id="site-title">dengdezhao </a> : <a href="http://pelican.dengdezhao.cn/adfxue-xi-zong-jie-yi.html" id="page-title">"ADF学习总结(一)"</a></h1>
<time datetime="2013-04-19T00:00:00+08:00">2013-04-19(Friday) 00:00</time>            </header>

            <article>
                <h4>改变VO查询条件</h4>
<ul>
<li>使用WhereClause改变查询条件</li>
<li>使用Criteria改变查询条件</li>
<li>使用Bind Variables改变查询条件</li>
</ul>
<h4>使用WhereClause改变查询条件</h4>
<ul>
<li><strong>setWhereClause</strong>    </li>
</ul>
<p _="%" endcodeblock="endcodeblock">通过VO对象的setWhereClause方法改变查询条件
{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");  <br />
ViewObject vo = dc.getViewObject();     <br />
vo.setWhereClause(" 1=1 ");  <br />
vo.executeQuery();   <br /></p>
<ul>
<li><strong>addWhereClause</strong></li>
</ul>
<p>addWhereClause是在原有whereClause基础上添加新的查询条件；  <br />
跟setWhereClause替换原有whereClaue不同；</p>
<h4>使用ViewCriteria改变查询条件</h4>
<ul>
<li><strong>使用定义好的ViewCriteria</strong>    </li>
</ul>
<p>事先在创建VO的时候，定义好几种Criteria：DepartmentsViewCriteria    </p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");      <br />
ViewObject vo = dc.getViewObject();         <br />
ViewCriteriaManager vcm=vo.getViewCriteriaManager();  <br />
vo.applyViewCriteria(vcm.getViewCriteria("DepartmentsViewCriteria"));   <br />
vo.executeQuery();   <br /></p>
<ul>
<li><strong>动态创建ViewCriteria</strong>    </li>
</ul>
<p>如果事先没有在VO中定义好ViewCriteria，也可以在MB代码中动态创建    </p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");  <br />
ViewObject vo = dc.getViewObject();  <br />
ViewCriteria vc = vo.createViewCriteria();  <br />
ViewCriteriaRow vcr = vc.createViewCriteriaRow();  <br />
vcr.setConjunction(ViewCriteriaRow.VC_CONJ_AND);  <br />
vcr.setAttribute("DepartmentId", "20");  <br />
vc.add(vcr);  <br />
vo.applyViewCriteria(vc);  <br />
vo.executeQuery();      <br /></p>
<h4>使用Bind Variables改变查询条件</h4>
<ul>
<li><strong>使用Bind Variables结合ViewCriteria</strong></li>
</ul>
<p>参照以上定义ViewCriteria时，使用Bind Variables。    </p>
<ul>
<li><strong>使用Bind Variables结合SQL</strong></li>
</ul>
<p>在VO的SQL中使用Bind Variables；    </p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:sql %}
SELECT Departments.DEPARTMENT_ID, 
       Departments.DEPARTMENT_NAME, 
       Departments.MANAGER_ID, 
       Departments.LOCATION_ID
FROM DEPARTMENTS Departments
WHERE Departments.DEPARTMENT_ID = :varDeptId</p>
<p>创建Bind Variables：varDeptId    </p>
<p>在查询VO时，通过如下代码控制即可实现：    </p>
<p _="%" endcodeblock="endcodeblock">{% codeblock lang:java %}
DCIteratorBinding dc = ADFUtils.findIterator("DepartmentsView1Iterator");  <br />
ViewObject vo = dc.getViewObject();  <br />
ViewCriteria vc = vo.createViewCriteria();  <br />
vo.setNamedWhereClauseParam("varDeptId", 20);  <br />
vo.executeQuery();        <br /></p>
<p>以上几种方法均可实现改变VO查询条件进行动态查询，各有灵活度，目前没有比较三种方式带来的性能影响，可以根据个人习惯采用。</p>            </article>

        <footer>
            <nav>
                <ul>
                    <li>:: <a href="http://pelican.dengdezhao.cn/categories.html">Categories</a></li>
                    <li>:: <a href="http://pelican.dengdezhao.cn/tags.html">Tags</a></li>
                </ul>
            </nav>
                <p id="theme-credit"><a href="http://mathieu.agopian.info/mnmlist/theme.html">Thème mnmlist</a></p>
        </footer>

</body>
</html>