<!DOCTYPE html>
<html lang="en">
<head>
        <title>dengdezhao - excel</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://pelican.dengdezhao.cn/theme/css/main.css" type="text/css" />
        <link href="http://pelican.dengdezhao.cn/None" type="application/atom+xml" rel="alternate" title="dengdezhao ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie.css"/>
                <script src="http://pelican.dengdezhao.cn/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://pelican.dengdezhao.cn/css/ie6.css"/><![endif]-->

</head>

<body>
        
        

            <header>
                <h1><a href="http://pelican.dengdezhao.cn" id="site-title">dengdezhao </a> : <a href="http://pelican.dengdezhao.cn/getrowatrangeindexintfang-fa-de-ju-xian-xing.html" id="page-title">"getRowAtRangeIndex(int)方法的局限性"</a></h1>
<time datetime="2013-04-16T00:00:00+08:00">2013-04-16(Tuesday) 00:00</time>            </header>

            <article>
                <p _="%" endcodeblock="endcodeblock">导出VO中的数据到EXCEL中时，循环VO中的Row，写入HSSFRow，是通过getRowAtRangeIndex(int)方法循环取Row，代码如下：  <br />
{% codeblock lang:java %}
 ViewObject vo8=am.findViewObject("ChReport1VO1");
 if(vo8!=null)
 {
      int rowcount8=vo8.getRowCount();
      for(int i=0;i&lt;rowcount8;i++)
      {
           Row vo_row8=vo8.getRowAtRangeIndex(i);
           //...TODO
      }
 }</p>
<p>这样如果VO里有300条数据，但是pageRange设置为100，这里其实只能取到第一页的100条数据，想要导出所有300条数据则需要一页一页导出，很麻烦。于是考虑不用getRowAtRangeIndex方法取ROW数据,改用RowSetIterator。</p>
<p>{% codeblock lang:java %}
ViewObject vo8=am.findViewObject("ChReport1VO1");
if(vo8!=null)
{
     int rowcount8=vo8.getRowCount();
     RowSetIterator rowSetIter=vo8.createRowSetIterator(null);</p>
<div class="highlight"><pre><span></span> for(int i=0;i&lt;rowcount8;i++)
 {
       Row vo_row8=rowSetIter.next();
       //...TODO
 }
</pre></div>


<p _="%" endcodeblock="endcodeblock" lang:java="lang:java">}</p>
<p>getRowAtRangeIndex方法只能通过index取出Range中的数据,但是RowSetIterator则是对VO中所有RowSet遍历。</p>            </article>

        <footer>
            <nav>
                <ul>
                    <li>:: <a href="http://pelican.dengdezhao.cn/categories.html">Categories</a></li>
                    <li>:: <a href="http://pelican.dengdezhao.cn/tags.html">Tags</a></li>
                </ul>
            </nav>
                <p id="theme-credit"><a href="http://mathieu.agopian.info/mnmlist/theme.html">Thème mnmlist</a></p>
        </footer>

</body>
</html>